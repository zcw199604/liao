# 变更历史索引

本文件记录所有已完成变更的索引，便于追溯和查询。

---

## 索引

| 时间戳 | 功能名称 | 类型 | 状态 | 方案包路径 |
|--------|----------|------|------|------------|
| 202601041818 | fix_history_userlist_lastmsg | 修复 | ✅已完成 | [链接](2026-01/202601041818_fix_history_userlist_lastmsg/) |
| 202601041854 | fix_lastmsg_key_normalize | 修复 | ✅已完成 | [链接](2026-01/202601041854_fix_lastmsg_key_normalize/) |
| 202601042052 | frontend-tests | 测试 | ✅已完成 | [链接](2026-01/202601042052_frontend-tests/) |
| 202601042237 | fix_list_time_and_favorite_enrich | 修复 | ⚠️待复验 | [链接](2026-01/202601042237_fix_list_time_and_favorite_enrich/) |
| 202601051001 | vue-component-tests | 测试 | ✅已完成 | [链接](2026-01/202601051001_vue-component-tests/) |
| 202601051025 | vue-view-tests | 测试 | ✅已完成 | [链接](2026-01/202601051025_vue-view-tests/) |
| 202601051105 | frontend-test-coverage | 测试 | ✅已完成 | [链接](2026-01/202601051105_frontend-test-coverage/) |
| 202601051213 | perf_userlist_timing_logs | 优化 | ⚠️待复验 | [链接](2026-01/202601051213_perf_userlist_timing_logs/) |
| 202601060948 | chat_gesture_ux | 功能 | ✅已完成 | [链接](2026-01/202601060948_chat_gesture_ux/) |
| 202601062010 | fix_unread_badge_list | 修复 | ✅已完成 | [链接](2026-01/202601062010_fix_unread_badge_list/) |
| 202601062034 | refine_unread_route_cleanup | 修复 | ✅已完成 | [链接](2026-01/202601062034_refine_unread_route_cleanup/) |
| 202601071248 | go_backend_rewrite | 重构 | ✅已完成 | [链接](2026-01/202601071248_go_backend_rewrite/) |
| 202601071533 | release_v1_0_0 | 发布 | ✅已完成 | [链接](2026-01/202601071533_release_v1_0_0/) |
| 202601072015 | go_logging_align_java | 修复 | ⚠️待复验 | [链接](2026-01/202601072015_go_logging_align_java/) |
| 202601072058 | fix_delete_media_403 | 修复 | ⚠️待复验 | [链接](2026-01/202601072058_fix_delete_media_403/) |
| 202601092143 | ws_identity_switch | 修复 | ✅已完成 | [链接](2026-01/202601092143_ws_identity_switch/) |
| 202601101526 | fix_ws_self_echo_alignment | 修复 | ✅已完成 | [链接](2026-01/202601101526_fix_ws_self_echo_alignment/) |
| 202601101530 | tests_auth_ws_reconnect_crud | 测试 | ✅已完成 | [链接](2026-01/202601101530_tests_auth_ws_reconnect_crud/) |
| 202601101607 | image_hash_duplicate_check | 功能 | ✅已完成 | [链接](2026-01/202601101607_image_hash_duplicate_check/) |
| 202601102011 | go_file_tests | 测试 | ✅已完成 | [链接](2026-01/202601102011_go_file_tests/) |
| 202601102152 | go_file_tests_more | 测试 | ✅已完成 | [链接](2026-01/202601102152_go_file_tests_more/) |
| 202601102213 | java_backend_deprecated | 文档 | ✅已完成 | [链接](2026-01/202601102213_java_backend_deprecated/) |
| 202601102319 | image_port_strategy | 功能 | ✅已完成 | [链接](2026-01/202601102319_image_port_strategy/) |
| 202601110511 | image_port_race | 优化 | ✅已完成 | [链接](2026-01/202601110511_image_port_race/) |
| 202601120630 | fix_lastmsg_emoji_preview | 修复 | ⚠️待复验 | [链接](2026-01/202601120630_fix_lastmsg_emoji_preview/) |
| 202601171004 | fix_chat_media_dedup | 修复 | ✅已完成 | [链接](2026-01/202601171004_fix_chat_media_dedup/) |
| 202601171351 | fix_spa_refresh_404 | 修复 | ✅已完成 | [链接](2026-01/202601171351_fix_spa_refresh_404/) |
| 202601180621 | chat_inline_media | 功能 | ✅已完成 | [链接](2026-01/202601180621_chat_inline_media/) |
| 202601180647 | fix_chat_list_self_lastmsg_promote | 修复 | ✅已完成 | [链接](2026-01/202601180647_fix_chat_list_self_lastmsg_promote/) |
| 202601181106 | upstash_redis_url | 功能 | ✅已完成 | [链接](2026-01/202601181106_upstash_redis_url/) |
| 202601181127 | redis_write_batch_flush | 优化 | ✅已完成 | [链接](2026-01/202601181127_redis_write_batch_flush/) |
| 202601181156 | userlist_local_cache | 优化 | ✅已完成 | [链接](2026-01/202601181156_userlist_local_cache/) |
| 202601181213 | redis_local_cache_only | 修复 | ✅已完成 | [链接](2026-01/202601181213_redis_local_cache_only/) |
| 202601181444 | mtphoto_album | 功能 | ✅已完成 | [链接](2026-01/202601181444_mtphoto_album/) |
| 202601181549 | mtphoto_preview_gallery | 修复 | ⚠️待复验 | [链接](2026-01/202601181549_mtphoto_preview_gallery/) |
| 202601181746 | chat_ux_upgrade | 优化 | ✅已完成 | [链接](2026-01/202601181746_chat_ux_upgrade/) |
| 202601190055 | mtphoto_refresh_token | 优化 | ✅已完成 | [链接](2026-01/202601190055_mtphoto_refresh_token/) |
| 202601190109 | mtphoto_preview_detail | 修复 | ⚠️待复验 | [链接](2026-01/202601190109_mtphoto_preview_detail/) |

---

## 按月归档

### 2026-01

- [202601041818_fix_history_userlist_lastmsg](2026-01/202601041818_fix_history_userlist_lastmsg/) - 修复历史用户列表 lastMsg/lastTime 增强对 `UserID/userid` 的兼容性
- [202601041854_fix_lastmsg_key_normalize](2026-01/202601041854_fix_lastmsg_key_normalize/) - 修复消息id/toid与myUserID不一致导致 lastMsg/lastTime 无法命中
- [202601042052_frontend-tests](2026-01/202601042052_frontend-tests/) - 前端接入 Vitest 并补充核心模块单元测试
- [202601042237_fix_list_time_and_favorite_enrich](2026-01/202601042237_fix_list_time_and_favorite_enrich/) - 修复聊天列表时间格式化不一致，并对齐收藏列表缓存增强（待JDK17环境复验）
- [202601051001_vue-component-tests](2026-01/202601051001_vue-component-tests/) - 前端补充 Vue 组件级测试（SFC 渲染/交互）
- [202601051025_vue-view-tests](2026-01/202601051025_vue-view-tests/) - 前端补充视图级页面测试（LoginPage/IdentityPicker/ChatListView/ChatRoomView）
- [202601051105_frontend-test-coverage](2026-01/202601051105_frontend-test-coverage/) - 前端补充核心聊天业务与关键组件测试覆盖（composables/store/components/utils）
- [202601051213_perf_userlist_timing_logs](2026-01/202601051213_perf_userlist_timing_logs/) - 为历史/收藏用户列表增加分段耗时日志（上游/补充用户信息/最后消息/总耗时）
- [202601060948_chat_gesture_ux](2026-01/202601060948_chat_gesture_ux/) - 聊天手势与弹层交互增强（列表左右滑切换/边缘右滑返回/抽屉左滑关闭/点击外关闭）
- [202601062010_fix_unread_badge_list](2026-01/202601062010_fix_unread_badge_list/) - 修复列表页未读气泡误判不显示（路由判定 + 会话状态清理双保险）
- [202601062034_refine_unread_route_cleanup](2026-01/202601062034_refine_unread_route_cleanup/) - 未读判定改用路由实例，并简化聊天页卸载清理逻辑
- [202601071248_go_backend_rewrite](2026-01/202601071248_go_backend_rewrite/) - 后端重构为 Go（API + /ws 100%兼容，MySQL + 可选 Redis，单容器运行）
- [202601071533_release_v1_0_0](2026-01/202601071533_release_v1_0_0/) - 新增 GitHub Actions Release 工作流（创建/推送 Tag 并生成 GitHub Release 产物）
- [202601072015_go_logging_align_java](2026-01/202601072015_go_logging_align_java/) - Go 日志对齐 Java 版（User History 分段耗时/鉴权告警等）
- [202601072058_fix_delete_media_403](2026-01/202601072058_fix_delete_media_403/) - 修复 `/api/deleteMedia` 兼容多种 localPath 形式，并对齐全站图片库删除行为（不按 userId 校验）
- [202601092143_ws_identity_switch](2026-01/202601092143_ws_identity_switch/) - 修复切换身份后 WS 仍绑定旧用户导致匹配无响应/仍收旧消息
- [202601101526_fix_ws_self_echo_alignment](2026-01/202601101526_fix_ws_self_echo_alignment/) - 修复 WS 私信回显自己消息方向判定（避免自己消息显示在左侧）
- [202601101530_tests_auth_ws_reconnect_crud](2026-01/202601101530_tests_auth_ws_reconnect_crud/) - 补齐认证/WebSocket/重连/收藏&历史列表测试用例（P0-P2）
- [202601101607_image_hash_duplicate_check](2026-01/202601101607_image_hash_duplicate_check/) - 新增媒体查重接口（MD5 + pHash 相似度阈值查询）
- [202601102011_go_file_tests](2026-01/202601102011_go_file_tests/) - Go 文件功能测试补齐（FileStorage/MediaUpload/ImageHash/handlers）
- [202601102152_go_file_tests_more](2026-01/202601102152_go_file_tests_more/) - Go 文件相关接口测试补齐（历史/缓存/删除/重传/修复等 handler）
- [202601102213_java_backend_deprecated](2026-01/202601102213_java_backend_deprecated/) - 标记历史 Java(Spring Boot) 后端目录为已弃用，仅供参考
- [202601102319_image_port_strategy](2026-01/202601102319_image_port_strategy/) - 新增全局图片端口策略配置（fixed/probe/real）与 Settings 切换
- [202601110511_image_port_race](2026-01/202601110511_image_port_race/) - 图片端口解析优化：real 并发竞速与全失败降级兜底（回退 probe/fixed）
- [202601120630_fix_lastmsg_emoji_preview](2026-01/202601120630_fix_lastmsg_emoji_preview/) - 修复会话列表 lastMsg 预览将表情文本（如 `[doge]`）误识别为 `[文件]`
- [202601171004_fix_chat_media_dedup](2026-01/202601171004_fix_chat_media_dedup/) - 修复聊天记录媒体消息偶发重复显示（WS 推送与历史拉取合并语义去重）
- [202601171351_fix_spa_refresh_404](2026-01/202601171351_fix_spa_refresh_404/) - 修复 SPA 路由在 list/chat 页面刷新 404（Go 静态回退通用化）
- [202601180621_chat_inline_media](2026-01/202601180621_chat_inline_media/) - 支持聊天消息“文字 + [path] 媒体占位符”混排渲染（图文同显 + lastMsg 摘要）
- [202601180647_fix_chat_list_self_lastmsg_promote](2026-01/202601180647_fix_chat_list_self_lastmsg_promote/) - 修复聊天页自己发送消息回显时，会话列表未置顶（消息/收藏）且 lastMsg 预览未加 `我: ` 前缀
- [202601181106_upstash_redis_url](2026-01/202601181106_upstash_redis_url/) - 支持通过 `rediss://` 连接串接入 Upstash Redis（`UPSTASH_REDIS_URL`/`REDIS_URL`）
- [202601181127_redis_write_batch_flush](2026-01/202601181127_redis_write_batch_flush/) - Redis 写入改为队列批量 flush（默认 60 秒，可配置）
- [202601181156_userlist_local_cache](2026-01/202601181156_userlist_local_cache/) - 历史/收藏用户列表本地缓存（默认 1 小时）+ 缓存增强并发批量读取
- [202601181213_redis_local_cache_only](2026-01/202601181213_redis_local_cache_only/) - 移除上游列表本地缓存，仅保留 Redis 本地缓存（默认 1 小时）并保留并发增强
- [202601181444_mtphoto_album](2026-01/202601181444_mtphoto_album/) - 接入 mtPhoto 相册并支持按相册浏览与一键导入上传
- [202601181549_mtphoto_preview_gallery](2026-01/202601181549_mtphoto_preview_gallery/) - mtPhoto 相册图片预览支持左右切换浏览（切换后导入目标对齐）
- [202601181746_chat_ux_upgrade](2026-01/202601181746_chat_ux_upgrade/) - 聊天体验优化：乐观发送/骨架屏/虚拟滚动/ChatMedia
- [202601190055_mtphoto_refresh_token](2026-01/202601190055_mtphoto_refresh_token/) - mtPhoto 续期支持 refresh_token（优先 `/auth/refresh`，失败回退 `/auth/login`）
- [202601190109_mtphoto_preview_detail](2026-01/202601190109_mtphoto_preview_detail/) - mtPhoto 相册预览支持查看详情（信息按钮 + 详情面板）
