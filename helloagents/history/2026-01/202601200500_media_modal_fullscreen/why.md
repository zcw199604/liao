# 变更提案: 图片弹窗全屏模式（全站图片库/mtPhoto 相册）

## 需求背景
当前“所有上传图片”（`AllUploadImageModal`）与“mtPhoto 相册”（`MtPhotoAlbumModal`）以居中弹窗展示，尺寸约束为 `w-[95%] max-w-[1600px] h-[90vh]`。在大屏/高分辨率下仍存在留白，浏览/筛选大量图片时需要更频繁的滚动与切换视线。

本变更提供“全屏/退出全屏”模式，使弹窗可一键最大化占满视口，提升大量图片浏览、预览与管理效率。

## 产品分析

### 目标用户与场景
- **用户群体:** 重度图片用户（频繁挑选素材发送、整理/删除历史上传图片）
- **使用场景:** 大屏或横屏设备中快速扫图、定位目标、批量操作；在“全站图片库/mtPhoto 相册”之间来回切换时希望保持一致的浏览体验
- **核心痛点:** 弹窗尺寸固定导致可视区域受限、留白占用屏幕、长列表浏览需要更多滚动

### 价值主张与成功指标
- **价值主张:** 最大化可视区域，减少滚动成本，提升“浏览 → 预览 → 选择/上传/删除”的闭环效率
- **成功指标:**
  - 单屏可见缩略图数量提升（主观感知 + 可手工对比）
  - 选择目标图片耗时下降（手工验收可观察）
  - 全屏偏好复用率提升（启用 localStorage 持久化后）

### 人文关怀
- 避免误触：提供明确的退出入口与一致的 `Esc` 行为（优先退出全屏，其次关闭弹窗）
- 视觉舒适：保持现有遮罩与对比度，避免过度刺激

## 变更内容
1. 在“所有上传图片”和“mtPhoto 相册”弹窗头部新增“全屏/退出全屏”切换按钮
2. 全屏模式下弹窗容器占满视口，减少/取消圆角与阴影，内容区可视面积最大化
3. 支持快捷键：`F` 切换全屏，`Esc` 退出全屏（若未全屏则关闭弹窗）
4. 全屏状态持久化到 localStorage，并在两种弹窗间保持一致（与 `media_layout_mode` 的持久化策略一致）

## 影响范围
- **模块:** Media（全站图片库）、mtPhoto（相册）、（可选）Common（抽取复用逻辑）
- **文件:**
  - `frontend/src/components/media/AllUploadImageModal.vue`
  - `frontend/src/components/media/MtPhotoAlbumModal.vue`
  - （可选）`frontend/src/composables/useModalFullscreen.ts`
- **API:** 无
- **数据:** 无

## 核心场景

### 需求: 弹窗全屏模式
**模块:** Media / mtPhoto
为大屏浏览大量图片提供最大化视图。

#### 场景: 开启全屏
打开“所有上传图片”或进入“mtPhoto 相册媒体”页面后，点击“全屏”按钮：
- 弹窗占满视口，图片列表可视区域增大
- 再次点击“退出全屏”恢复原尺寸

#### 场景: 快捷键控制
弹窗打开时（焦点不在输入框，本弹窗默认无输入）：
- 按 `F` 切换全屏/退出全屏
- 按 `Esc`：若处于全屏 → 退出全屏；否则关闭弹窗

#### 场景: 状态持久化
用户曾开启全屏并关闭弹窗：
- 下次打开任一弹窗保持上次的全屏偏好（localStorage）

## 风险评估
- **风险:** 键盘事件与 `MediaPreview` 的 `Esc` 关闭逻辑潜在冲突
- **缓解:** 仅在对应弹窗可见时注册监听；当 `MediaPreview` 打开时允许其优先处理 `Esc`（或在弹窗侧避免重复消费）
- **风险:** 移动端 `vh` 与地址栏导致的可视高度偏差
- **缓解:** 使用 `dvh`（如 `100dvh`）作为主高度并保留 `h-screen` 兜底

